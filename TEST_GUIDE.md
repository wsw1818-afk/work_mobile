# Excel 가져오기 테스트 가이드

## APK 위치
```
D:\OneDrive\코드작업\결과물\gagyebu\gagyebu-native-debug.apk
```

## 테스트 파일
```
D:\OneDrive\코드작업\카카오톡 받은 파일\신한은행_거래내역조회_20250924132835.xls
```

## 테스트 절차

### 1. APK 설치
```bash
adb install -r "D:\OneDrive\코드작업\결과물\gagyebu\gagyebu-native-debug.apk"
```

### 2. 앱 실행 및 초기 데이터 확인
1. 앱 실행
2. **대시보드** 화면에서 현재 거래 수 확인
3. **거래내역** 화면에서 기존 거래 확인

### 3. Excel 파일 가져오기
1. 좌측 메뉴 → **거래 가져오기** 선택
2. **Excel 파일 선택** 버튼 클릭
3. 신한은행 파일 선택: `신한은행_거래내역조회_20250924132835.xls`
4. **파싱 완료 Alert** 확인:
   ```
   1개 파일에서 총 420개의 거래를 찾았습니다.
   수입 74개 / 지출 346개
   → 최종 420개
   미리보기를 확인하고 가져오기를 진행하세요.
   ```

### 4. 예상 결과 검증

**파싱 완료 Alert에서 확인해야 할 것:**
- ✅ 총 거래 수: 420개
- ✅ **수입: 74개** (입금 내역)
- ✅ **지출: 346개** (출금 내역)

**미리보기 화면에서 확인:**
- 처음 몇 개 거래가 올바르게 표시되는지 확인
- 입금 거래 예시:
  - 날짜: 2025-09-24
  - 금액: 300원
  - 내용: 주택금융공사

### 5. 가져오기 실행
1. **거래 가져오기** 버튼 클릭
2. 확인 Alert에서 **가져오기** 선택
3. **가져오기 완료 Alert** 확인:
   ```
   성공: X개
   DB 중복으로 제외: Y개
   ```

### 6. 거래 반영 확인

#### 6-1. 대시보드에서 확인
1. 좌측 메뉴 → **대시보드** 선택
2. **이번 달 수입** 금액 확인 (74개 입금 거래 합계)
3. **이번 달 지출** 금액 확인 (346개 출금 거래 합계)

#### 6-2. 거래내역에서 확인
1. 좌측 메뉴 → **거래내역** 선택
2. 9월 선택 (또는 해당 월)
3. 거래 목록에서 **입금 거래** 찾기:
   - 주택금융공사 300원
   - K-패스환급금 9,880원
   - 9월 급여 5,298,157원 등
4. 각 거래를 클릭하여 상세 정보 확인

### 7. 로그 확인 (개발자 도구)

React Native 개발자 메뉴 (앱에서 흔들기 또는 Ctrl+M):
```
Debug JS Remotely → Chrome DevTools → Console
```

**예상 로그:**
```
[applyMapping] ✅ 입금 거래 생성: 2025-09-24 / 주택금융공사 / 300원
[applyMapping] ✅ 입금 거래 생성: 2025-09-20 / 06.21~09.19 / 3793원
...
[파싱 완료] 원본 거래: 수입 74개, 지출 346개
[파싱 완료] 최종 거래: 수입 74개, 지출 346개
[DB 저장] ✅ 입금 추가: 2025-09-24 / 주택금융공사 / 300원
...
```

## 문제 발생 시 체크리스트

### ❌ "수입 0개"로 표시되는 경우
**원인**: 파싱 문제
**확인**: 로그에서 `[applyMapping] ✅ 입금 거래 생성` 메시지 확인
**해결**: `lib/excel-parser.ts`의 `inferTransactionType` 함수 확인

### ❌ 파싱은 되는데 DB에 저장 안 되는 경우
**원인**: DB 저장 실패 또는 중복 제거
**확인**: 로그에서 `[DB 저장] ✅ 입금 추가` 메시지 확인
**확인2**: `[DB 중복] 스킵` 메시지 확인
**해결**: `screens/ImportScreen.tsx`의 `importTransactions` 함수 확인

### ❌ DB에 저장되는데 화면에 반영 안 되는 경우
**원인**: 화면 갱신 문제
**확인**: `notifyTransactionAdded()` 호출 확인
**해결**: 앱 재시작 후 대시보드/거래내역 다시 확인

## 최종 검증 포인트

- [ ] 파싱 완료 Alert에 "수입 74개 / 지출 346개" 표시
- [ ] 가져오기 완료 Alert에 "성공: 420개" (또는 중복 제외 수)
- [ ] 대시보드의 "이번 달 수입" 금액이 증가
- [ ] 거래내역에서 입금 거래(주택금융공사, 급여 등) 확인 가능
- [ ] 각 거래 클릭 시 상세 정보 표시

## 예상 입금 거래 목록 (처음 10개)

1. 2025-09-24 | 300원 | 주택금융공사
2. 2025-09-20 | 3,793원 | 06.21~09.19 (이자)
3. 2025-09-19 | 5,298,157원 | 9월 급여
4. 2025-09-11 | 9,880원 | K-패스환급금
5. 2025-09-05 | 150,000원 | SKNS노동조합
6. 2025-08-25 | 340원 | 주택금융공사
7. 2025-08-20 | 3,531,407원 | 8월 급여
8. 2025-08-18 | 1원 | 4351 신한카드
9. 2025-08-13 | 14,050원 | K패스환급금
10. 2025-07-31 | 1원 | 카카오370
