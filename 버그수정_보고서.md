# ğŸ› OCR ë° Excel ê°€ì ¸ì˜¤ê¸° ë²„ê·¸ ìˆ˜ì • ë³´ê³ ì„œ

## ğŸ“… ìˆ˜ì • ì¼ì: 2025-01-15

---

## ğŸ” ë°œê²¬ëœ ë¬¸ì œì 

### 1. **OpenAI SDK React Native ë¹„í˜¸í™˜ì„± (ì¹˜ëª…ì )**
**íŒŒì¼**: [lib/ai-ocr.ts](lib/ai-ocr.ts)

**ë¬¸ì œ**:
- `openai` npm íŒ¨í‚¤ì§€ëŠ” **Node.js ì „ìš©** ë¼ì´ë¸ŒëŸ¬ë¦¬ì…ë‹ˆë‹¤
- `https`, `fs`, `stream` ë“± Node.js APIë¥¼ ì‚¬ìš©í•˜ì—¬ React Native í™˜ê²½ì—ì„œ **ì‹¤í–‰ ë¶ˆê°€**
- ì˜ìˆ˜ì¦ ìŠ¤ìº” ì‹œ ëŸ°íƒ€ì„ í¬ë˜ì‹œ ë°œìƒ

**ì¦ìƒ**:
```javascript
// âŒ ì´ì „ ì½”ë“œ (ì‘ë™ ì•ˆ í•¨)
import OpenAI from "openai";
const openai = new OpenAI({ apiKey });
```

**í•´ê²°**:
```javascript
// âœ… ìˆ˜ì •ëœ ì½”ë“œ (React Native í˜¸í™˜)
// OpenAI SDK ëŒ€ì‹  fetch API ì‚¬ìš©
const response = await fetch('https://api.openai.com/v1/chat/completions', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${apiKey}`,
  },
  body: JSON.stringify({ model, messages, max_tokens }),
});
```

---

### 2. **ImportScreen í•„ë“œ ì°¸ì¡° ì˜¤ë¥˜**
**íŒŒì¼**: [screens/ImportScreen.tsx](screens/ImportScreen.tsx)
**ë¼ì¸**: 145

**ë¬¸ì œ**:
- `tx.description` í•„ë“œê°€ `NormalizedTransaction` ì¸í„°í˜ì´ìŠ¤ì— ì¡´ì¬í•˜ì§€ ì•ŠìŒ
- ì‹¤ì œë¡œëŠ” `tx.memo` ë˜ëŠ” `tx.merchant` í•„ë“œë¥¼ ì‚¬ìš©í•´ì•¼ í•¨

**ì¦ìƒ**:
```typescript
// âŒ ì´ì „ ì½”ë“œ (ëŸ°íƒ€ì„ ì˜¤ë¥˜)
description: tx.description || '',  // undefined!
```

**í•´ê²°**:
```typescript
// âœ… ìˆ˜ì •ëœ ì½”ë“œ
description: tx.memo || tx.merchant || '',
```

---

### 3. **ImportScreen íƒ€ì… ì˜¤ë¥˜**
**íŒŒì¼**: [screens/ImportScreen.tsx](screens/ImportScreen.tsx)
**ë¼ì¸**: 236-239

**ë¬¸ì œ**:
- `parseResult.cardIssuer` ì†ì„±ì´ `ParseResult` íƒ€ì…ì— ì •ì˜ë˜ì§€ ì•ŠìŒ
- ë Œë”ë§ ì‹œ TypeScript ì˜¤ë¥˜ ë°œìƒ

**ì¦ìƒ**:
```tsx
{/* âŒ ì´ì „ ì½”ë“œ (íƒ€ì… ì˜¤ë¥˜) */}
{parseResult.cardIssuer && (
  <Chip icon="bank" style={styles.chip}>
    {parseResult.cardIssuer}
  </Chip>
)}
```

**í•´ê²°**:
```tsx
{/* âœ… ìˆ˜ì •ëœ ì½”ë“œ - ë¶ˆí•„ìš”í•œ ì½”ë“œ ì œê±° */}
{/* cardNameìœ¼ë¡œ ì¶©ë¶„íˆ í‘œì‹œë¨ */}
```

---

## âœ… ìˆ˜ì • ì‚¬í•­ ìš”ì•½

| íŒŒì¼ | ë³€ê²½ ë‚´ìš© | ì˜í–¥ |
|------|----------|------|
| [lib/ai-ocr.ts](lib/ai-ocr.ts:1-120) | OpenAI SDK â†’ fetch API ì „í™˜ | OCR ê¸°ëŠ¥ React Nativeì—ì„œ ì •ìƒ ì‘ë™ |
| [screens/ImportScreen.tsx](screens/ImportScreen.tsx:145) | `tx.description` â†’ `tx.memo \|\| tx.merchant` | Excel ê°€ì ¸ì˜¤ê¸° ì‹œ ì˜¤ë¥˜ í•´ê²° |
| [screens/ImportScreen.tsx](screens/ImportScreen.tsx:236-239) | `parseResult.cardIssuer` ì½”ë“œ ì œê±° | TypeScript íƒ€ì… ì˜¤ë¥˜ í•´ê²° |
| [package.json](package.json:26) | `openai` íŒ¨í‚¤ì§€ ì œê±° | ë¶ˆí•„ìš”í•œ ì˜ì¡´ì„± ì œê±° |

---

## ğŸ“ ê¸°ìˆ  ì„¸ë¶€ì‚¬í•­

### OpenAI API fetch êµ¬í˜„
```typescript
// React Native í˜¸í™˜ OpenAI Vision API í˜¸ì¶œ
const response = await fetch('https://api.openai.com/v1/chat/completions', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${apiKey}`,
  },
  body: JSON.stringify({
    model: model,
    messages: [
      {
        role: "user",
        content: [
          { type: "text", text: "ì˜ìˆ˜ì¦ ë¶„ì„ í”„ë¡¬í”„íŠ¸..." },
          {
            type: "image_url",
            image_url: { url: `data:image/jpeg;base64,${base64Image}` }
          }
        ]
      }
    ],
    max_tokens: 1000,
  }),
});

if (!response.ok) {
  const errorText = await response.text();
  throw new Error(`OpenAI API ì˜¤ë¥˜: ${response.status} - ${errorText}`);
}

const data = await response.json();
const content = data.choices?.[0]?.message?.content;
```

### NormalizedTransaction ì¸í„°í˜ì´ìŠ¤
```typescript
// lib/excel-parser.ts ì •ì˜
export interface NormalizedTransaction {
  date: string;
  amount: number;
  type: 'expense' | 'income';
  merchant?: string;  // âœ… ì¡´ì¬
  memo?: string;      // âœ… ì¡´ì¬
  account?: string;
  original: ParsedRow;
  // description í•„ë“œëŠ” ì—†ìŒ! âŒ
}
```

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹œë‚˜ë¦¬ì˜¤

### OCR ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
1. ì„¤ì • í™”ë©´ì—ì„œ OpenAI ë˜ëŠ” Gemini API í‚¤ ì…ë ¥
2. ì˜ìˆ˜ì¦ ìŠ¤ìº” í™”ë©´ ì´ë™
3. ì¹´ë©”ë¼ ë˜ëŠ” ê°¤ëŸ¬ë¦¬ì—ì„œ ì˜ìˆ˜ì¦ ì´ë¯¸ì§€ ì„ íƒ
4. **ì˜ˆìƒ ê²°ê³¼**: AIê°€ 5ì´ˆ ë‚´ì— ê¸ˆì•¡, ê°€ë§¹ì , ë‚ ì§œ ì¶”ì¶œ ì„±ê³µ
5. **ì´ì „**: ëŸ°íƒ€ì„ í¬ë˜ì‹œ ë°œìƒ âŒ
6. **ìˆ˜ì • í›„**: ì •ìƒ ì‘ë™ âœ…

### Excel ê°€ì ¸ì˜¤ê¸° í…ŒìŠ¤íŠ¸
1. ê±°ë˜ ê°€ì ¸ì˜¤ê¸° í™”ë©´ ì´ë™
2. ì‹ ìš©ì¹´ë“œ ëª…ì„¸ì„œ Excel íŒŒì¼ ì„ íƒ
3. ë¯¸ë¦¬ë³´ê¸° í™•ì¸
4. "ê±°ë˜ ê°€ì ¸ì˜¤ê¸°" ë²„íŠ¼ í´ë¦­
5. **ì˜ˆìƒ ê²°ê³¼**: ëª¨ë“  ê±°ë˜ê°€ ì •ìƒì ìœ¼ë¡œ ì¶”ê°€ë¨
6. **ì´ì „**: `tx.description is undefined` ì˜¤ë¥˜ âŒ
7. **ìˆ˜ì • í›„**: ì •ìƒ ì‘ë™ âœ…

---

## ğŸ“¦ ë‹¤ìŒ ë‹¨ê³„

### ê¶Œì¥ ì‚¬í•­
1. **npm install ì‹¤í–‰** - `openai` íŒ¨í‚¤ì§€ ì œê±° ë°˜ì˜
2. **ì•± ì¬ë¹Œë“œ** - ìˆ˜ì •ëœ ì½”ë“œë¡œ ìƒˆ APK ìƒì„±
3. **ì‹¤ì œ ê¸°ê¸° í…ŒìŠ¤íŠ¸** - OCR ë° Excel ê°€ì ¸ì˜¤ê¸° ê¸°ëŠ¥ ê²€ì¦

### ë¹Œë“œ ëª…ë ¹ì–´
```bash
# ì˜ì¡´ì„± ì—…ë°ì´íŠ¸
npm install

# APK ë¹Œë“œ (EAS Build)
eas build --platform android --profile preview --non-interactive
```

---

## ğŸ¯ ì˜í–¥ ë°›ëŠ” ê¸°ëŠ¥

### âœ… ì •ìƒí™”ëœ ê¸°ëŠ¥
- **ì˜ìˆ˜ì¦ OCR**: OpenAI GPT-4 Vision API ì •ìƒ ì‘ë™
- **ì˜ìˆ˜ì¦ OCR**: Google Gemini Vision API (ê¸°ì¡´ ì •ìƒ)
- **Excel ê±°ë˜ ê°€ì ¸ì˜¤ê¸°**: 8ê°œ ì€í–‰/ì¹´ë“œì‚¬ íŒŒì‹± ì •ìƒ
- **ìë™ ë¶„ë¥˜**: 200+ íŒ¨í„´ ë§¤ì¹­ ì •ìƒ

### ğŸ”„ ë³€ê²½ ì—†ëŠ” ê¸°ëŠ¥
- ê±°ë˜ ê´€ë¦¬ (CRUD)
- ì¹´í…Œê³ ë¦¬ ê´€ë¦¬
- ì˜ˆì‚° ê´€ë¦¬
- ëŒ€ì‹œë³´ë“œ í†µê³„
- ëª¨ë“  ê¸°íƒ€ ê¸°ëŠ¥

---

## ğŸ“š ì°¸ê³  ìë£Œ

### React Nativeì—ì„œ OpenAI ì‚¬ìš©í•˜ê¸°
- [OpenAI API Reference](https://platform.openai.com/docs/api-reference)
- [React Native Fetch API](https://reactnative.dev/docs/network)
- [Vision API Guide](https://platform.openai.com/docs/guides/vision)

### ê´€ë ¨ íŒŒì¼
- [lib/ai-ocr.ts](lib/ai-ocr.ts) - AI OCR í†µí•©
- [lib/excel-parser.ts](lib/excel-parser.ts) - Excel íŒŒì‹±
- [lib/auto-categorize.ts](lib/auto-categorize.ts) - ìë™ ë¶„ë¥˜
- [screens/ReceiptScreen.tsx](screens/ReceiptScreen.tsx) - ì˜ìˆ˜ì¦ ìŠ¤ìº” í™”ë©´
- [screens/ImportScreen.tsx](screens/ImportScreen.tsx) - ê±°ë˜ ê°€ì ¸ì˜¤ê¸° í™”ë©´

---

**ìˆ˜ì • ì™„ë£Œ ì‹œê°**: 2025-01-15
**í…ŒìŠ¤íŠ¸ ìƒíƒœ**: ì½”ë“œ ìˆ˜ì • ì™„ë£Œ, ë¹Œë“œ ëŒ€ê¸° ì¤‘
**ë²„ì „**: v2.0.1 (ë²„ê·¸ ìˆ˜ì •)
